name: TravelTxter Pipeline

on:
  schedule:
    - cron: "30 7,16 * * *"   # 07:30 & 16:30 UTC
  workflow_dispatch:

concurrency:
  group: traveltxter-pipeline
  cancel-in-progress: false

jobs:

  feeder:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Feeder
        run: python workers/pipeline_worker.py

  scorer:
    needs: feeder
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Scorer
        run: python workers/ai_scorer.py

  renderer:
    needs: scorer
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Renderer
        run: python workers/render_client.py

  telegram:
    needs: renderer
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Telegram Publisher
        run: python workers/telegram_publisher.py

  instagram:
    needs: renderer
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Instagram Publisher
        run: python workers/instagram_publisher.py
